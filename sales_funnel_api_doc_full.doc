# Полная документация по API воронки продаж (Sales Funnel)

---

## Lead (Лид)

### Получить список лидов
GET /api/leads/
Ответ:
[
  {
    "id": 1,
    "name": "Лид 1",
    "contact": "example@mail.com",
    "varonka": 2,
    "current_task": 5,
    "is_done": false
  }
]

### Создать нового лида
POST /api/leads/
Тело запроса:
{
  "name": "Лид 2",
  "contact": "contact@mail.com",
  "varonka": 1,
  "current_task": 3,
  "is_done": false
}
Ответ: созданный объект Lead

### Получить детали лида
GET /api/leads/{id}/
Ответ:
{
  "id": 1,
  "name": "Лид 1",
  "contact": "example@mail.com",
  "varonka": 2,
  "current_task": 5,
  "is_done": false
}

### Обновить лида
PUT /api/leads/{id}/
PATCH /api/leads/{id}/
Тело запроса: (любое из полей Lead)
Ответ: обновлённый объект Lead

### Удалить лида
DELETE /api/leads/{id}/
Ответ: 204 No Content

---

## Varonka (Воронка)

### Получить список всех воронок
GET /api/varonkas/
Ответ:
[
  {
    "id": 1,
    "name": "Воронка продаж",
    "description": "Описание этапов"
  }
]

### Получить детали воронки
GET /api/varonkas/{id}/
Ответ:
{
  "id": 1,
  "name": "Воронка продаж",
  "description": "Описание этапов"
}

---

## VaronkaTask (Этап воронки)

### Получить список этапов для конкретной воронки
GET /api/varonkas/{varonka_id}/tasks/
Ответ:
[
  {
    "id": 5,
    "varonka": 1,
    "name": "Первый контакт",
    "order": 1
  }
]

### Получить детали этапа
GET /api/varonkas/{varonka_id}/tasks/{task_id}/
Ответ:
{
  "id": 5,
  "varonka": 1,
  "name": "Первый контакт",
  "order": 1
}

---

## Примеры запросов

### Получить все лиды (fetch)
```js
fetch('/api/leads/')
  .then(r => r.json())
  .then(console.log)
```

### Создать лид (axios)
```js
axios.post('/api/leads/', {
  name: 'Лид 3',
  contact: 'lead3@mail.com',
  varonka: 1,
  current_task: 2,
  is_done: false
})
```

---

## Примечания
- Все поля id — числовые.
- Для создания/обновления лида используйте id существующей воронки и этапа.
- Для получения этапов конкретной воронки используйте её id.
- Для удаления лида используйте DELETE.
- Для обновления PATCH можно отправлять только изменяемые поля.
- Для получения детальной информации по этапу используйте оба id: воронки и этапа.

---

## Структуры объектов

### Lead
- id: int
- name: str
- contact: str
- varonka: int (id воронки)
- current_task: int (id этапа)
- is_done: bool

### Varonka
- id: int
- name: str
- description: str

### VaronkaTask
- id: int
- varonka: int (id воронки)
- name: str
- order: int

---

Если нужно добавить дополнительные примеры или расширить документацию — сообщите!
